#!/data/data/com.termux/files/usr/bin/bash
# Smart folder navigator + file action chooser

path="."

while true; do
  echo
  echo "üìÇ Listing: $path"
  items=()
  idx=1
  for item in "$path"/*; do
    items+=( "$item" )
    printf "%2d) %s\n" "$idx" "$(basename "$item")"
    idx=$((idx+1))
  done

  echo
  read -p "Open ‚Äî Type number from above: " choice

  if ! [[ "$choice" =~ ^[0-9]+$ ]] \
     || [ "$choice" -lt 1 ] \
     || [ "$choice" -gt "${#items[@]}" ]; then
    echo "Invalid selection ‚Äî try again." >&2
    continue
  fi

  selected="${items[$((choice-1))]}"

  if [ -d "$selected" ]; then
    path="$selected"
    continue
  elif [ -f "$selected" ]; then
    echo
    echo "üìÑ File selected: $(basename "$selected")"
    echo "What would you like to do with the file?"
    echo "1) Open using external tool (termux-open)"
    echo "2) Edit using nano"
    read -p "Enter 1 or 2: " action

    case "$action" in
      1)
        termux-open "$selected"
        ;;
      2)
        nano "$selected"
        ;;
      *)
        echo "‚ùå Invalid option. Exiting."
        ;;
    esac

    exit 0
  else
    echo "‚ùì Not a file or folder ‚Äî exiting."
    exit 1
  fi
done
